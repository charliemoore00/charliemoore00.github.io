[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "Blog for Spring 2024, Machine Learning CSCI0451"
  },
  {
    "objectID": "posts/penguins-blog-post/index.html",
    "href": "posts/penguins-blog-post/index.html",
    "title": "Penguins Blog",
    "section": "",
    "text": "The aim of this analysis is to explore and analyze the Palmer Penguins dataset and construct a classifier that can predict the species of penguin (Adelie, Gentoo, Chinstrap) based on the other factors in the data. The findings revealed that a logistic regression model performed the best in predicting the penguin species based on selected features. The model achieved a high accuracy score of 99.6% on the training data and 100% on the test data. We also found the determining features are culmen length, culmen depth, and island location that allow us to classify the penguin species.\nFirst, we’ll load the palmer penguins dataset:\n\nimport pandas as pd\n\nurl = \"https://raw.githubusercontent.com/PhilChodrow/ml-notes/main/data/palmer-penguins/train.csv\"\ntrain = pd.read_csv(url)\n\nWe’ll take a quick peek at how the data looks:\n\ntrain.head(5)\n\n\n\n\n\n\n\n\nstudyName\nSample Number\nSpecies\nRegion\nIsland\nStage\nIndividual ID\nClutch Completion\nDate Egg\nCulmen Length (mm)\nCulmen Depth (mm)\nFlipper Length (mm)\nBody Mass (g)\nSex\nDelta 15 N (o/oo)\nDelta 13 C (o/oo)\nComments\n\n\n\n\n0\nPAL0809\n31\nChinstrap penguin (Pygoscelis antarctica)\nAnvers\nDream\nAdult, 1 Egg Stage\nN63A1\nYes\n11/24/08\n40.9\n16.6\n187.0\n3200.0\nFEMALE\n9.08458\n-24.54903\nNaN\n\n\n1\nPAL0809\n41\nChinstrap penguin (Pygoscelis antarctica)\nAnvers\nDream\nAdult, 1 Egg Stage\nN74A1\nYes\n11/24/08\n49.0\n19.5\n210.0\n3950.0\nMALE\n9.53262\n-24.66867\nNaN\n\n\n2\nPAL0708\n4\nGentoo penguin (Pygoscelis papua)\nAnvers\nBiscoe\nAdult, 1 Egg Stage\nN32A2\nYes\n11/27/07\n50.0\n15.2\n218.0\n5700.0\nMALE\n8.25540\n-25.40075\nNaN\n\n\n3\nPAL0708\n15\nGentoo penguin (Pygoscelis papua)\nAnvers\nBiscoe\nAdult, 1 Egg Stage\nN38A1\nYes\n12/3/07\n45.8\n14.6\n210.0\n4200.0\nFEMALE\n7.79958\n-25.62618\nNaN\n\n\n4\nPAL0809\n34\nChinstrap penguin (Pygoscelis antarctica)\nAnvers\nDream\nAdult, 1 Egg Stage\nN65A2\nYes\n11/24/08\n51.0\n18.8\n203.0\n4100.0\nMALE\n9.23196\n-24.17282\nNaN"
  },
  {
    "objectID": "posts/penguins-blog-post/index.html#explore",
    "href": "posts/penguins-blog-post/index.html#explore",
    "title": "Penguins Blog",
    "section": "Explore",
    "text": "Explore\n\nCreating visualizations to learn about our dataset.\nThe following table shows the means, minimums, and maximums of each column in the dataset, grouped by island. One thing to point out is that the mean for “Stage_Adult, 1 Egg Stage” is 1.0, therefore it won’t help us predict the species. No need to include it in future code!\nAlso, the means for the Delta values are very similar across the islands, so we can guess that if we include island in our model, the delta values won’t be very helpful in predicting the species.\n\npd.set_option('display.max_columns', None)\nX_train.groupby([\"Island_Biscoe\", \"Island_Dream\", \"Island_Torgersen\"]).agg([\"mean\", \"min\", \"max\"])\n\n\n\n\n\n\n\n\n\n\nCulmen Length (mm)\nCulmen Depth (mm)\nFlipper Length (mm)\nBody Mass (g)\nDelta 15 N (o/oo)\nDelta 13 C (o/oo)\nStage_Adult, 1 Egg Stage\nClutch Completion_No\nClutch Completion_Yes\nSex_FEMALE\nSex_MALE\n\n\n\n\n\nmean\nmin\nmax\nmean\nmin\nmax\nmean\nmin\nmax\nmean\nmin\nmax\nmean\nmin\nmax\nmean\nmin\nmax\nmean\nmin\nmax\nmean\nmin\nmax\nmean\nmin\nmax\nmean\nmin\nmax\nmean\nmin\nmax\n\n\nIsland_Biscoe\nIsland_Dream\nIsland_Torgersen\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n0\n0\n1\n39.350000\n34.4\n46.0\n18.441176\n15.9\n21.5\n192.235294\n176.0\n210.0\n3727.941176\n2900.0\n4700.0\n8.844635\n7.69778\n9.59462\n-25.748135\n-26.53870\n-23.90309\n1.0\n1\n1\n0.205882\n0\n1\n0.794118\n0\n1\n0.470588\n0\n1\n0.529412\n0\n1\n\n\n1\n0\n44.527835\n34.0\n58.0\n18.307216\n16.4\n21.2\n193.628866\n178.0\n212.0\n3734.793814\n2700.0\n4800.0\n9.163175\n8.01485\n10.02544\n-25.075329\n-26.69543\n-23.89017\n1.0\n1\n1\n0.123711\n0\n1\n0.876289\n0\n1\n0.525773\n0\n1\n0.474227\n0\n1\n\n\n1\n0\n0\n44.945600\n34.5\n55.9\n15.863200\n13.1\n21.1\n209.320000\n172.0\n230.0\n4702.000000\n2850.0\n6300.0\n8.394096\n7.63220\n9.79532\n-26.086192\n-27.01854\n-24.36130\n1.0\n1\n1\n0.072000\n0\n1\n0.928000\n0\n1\n0.520000\n0\n1\n0.480000\n0\n1\n\n\n\n\n\n\n\n\n\nHeatmap\nThe following visualization shows the correlation between different pairs of variables. Values close to 1 or -1 indicate more linear relationships. Given that there are three penguin species, the most helpful visual is one that shows three distinct clumps. This would then likely not be a linear correlation, and so values that are closer to zero may show clumped data. We can see some of the lowest correlations are Culmen Depth vs Culmen Length, Body Mass vs Culmen Depth, and Body Mass vs Culmen Length.\n\ncorr = X_train[[\"Culmen Length (mm)\", \"Culmen Depth (mm)\", \"Flipper Length (mm)\", \"Body Mass (g)\"]].corr()\nsns.heatmap(corr, annot=True, cmap='coolwarm')\n\n\n\n\n\n\n\n\n\n\nScatterplot\nThe following scatterplot shows the relationship between Culmen Depth (mm) on the X-axis and Body Mass (g) on the Y-axis. The scatterplot is colored by the sex of the penguin, with purple representing female and orange representing male. This scatterplot shows two distinct clusters of penguins, one in the upper left and the other bottom right. Since we have color-coded by gender, we can see that the clusters are not separated by gender! Perhaps the are separated by Species, in which case this relationship will be very important when creating a classification model. It’s likely that one of the penguin species is represented by the cluster in the upper left, and the other two are represented by the cluster in the bottom right. I make this assumption given that the lower right cluster is roughly twice the size of the other.\n\nsns.scatterplot(X_train, x=\"Culmen Depth (mm)\", y=\"Body Mass (g)\", hue=\"Sex_MALE\", palette=\"CMRmap\")"
  },
  {
    "objectID": "posts/whose-costs/index.html",
    "href": "posts/whose-costs/index.html",
    "title": "Whose Costs?",
    "section": "",
    "text": "Part A: Grab the Data\nWe’ll start by loading the data into a dataframe:\n\nimport pandas as pd\nurl = \"https://raw.githubusercontent.com/PhilChodrow/ml-notes/main/data/credit-risk/train.csv\"\ndf_train = pd.read_csv(url)\n\nWe’ll take a peak at how the data looks:\n\ndf_train.head()\n\n\n\n\n\n\n\n\nperson_age\nperson_income\nperson_home_ownership\nperson_emp_length\nloan_intent\nloan_grade\nloan_amnt\nloan_int_rate\nloan_status\nloan_percent_income\ncb_person_default_on_file\ncb_person_cred_hist_length\n\n\n\n\n0\n25\n43200\nRENT\nNaN\nVENTURE\nB\n1200\n9.91\n0\n0.03\nN\n4\n\n\n1\n27\n98000\nRENT\n3.0\nEDUCATION\nC\n11750\n13.47\n0\n0.12\nY\n6\n\n\n2\n22\n36996\nRENT\n5.0\nEDUCATION\nA\n10000\n7.51\n0\n0.27\nN\n4\n\n\n3\n24\n26000\nRENT\n2.0\nMEDICAL\nC\n1325\n12.87\n1\n0.05\nN\n4\n\n\n4\n29\n53004\nMORTGAGE\n2.0\nHOMEIMPROVEMENT\nA\n15000\n9.63\n0\n0.28\nN\n10\n\n\n\n\n\n\n\n\n\nPart B: Explore The Data\nCreate at least two visualizations and one summary table in which you explore patterns in the data. You might consider some questions like:\nHow does loan intent vary with the age, length of employment, or homeownership status of an individual? Which segments of prospective borrowers are offered low interest rates? Which segments are offered high interest rates? Which segments of prospective borrowers have access to large lines of credit?\n\n\nPart C: Build a Model\nPlease use any technique to construct a score function and threshold for predicting whether a prospective borrower is likely to default on a given loan. You may use all the features in the data except loan_grade (and the target variable loan_status), and you may choose any subset of these. There are several valid ways to approach this modeling task:\n\nChoose features and estimate entries of a weight vector w by hand (this is allowed but not recommended).\n(Recommended): Choose your features, estimate new ones if needed, and fit a score-based machine learning model to the data. My suggestion is LogisticRegression. Once you have fit a logistic regression model, the weight vector w is stored as the attribute model.coef_.\n\nI suggest that you try several combinations of features, possibly including some which you create, and test out which combinations work best with cross-validation.\n\n\nPart D: Find a Threshold\nOnce you have a weight vector w, it is time to choose a threshold t. To choose a threshold that maximizes profit for the bank, we need to make some assumptions about how the bank makes and loses money on loans. Let’s use the following (simplified) modeling assumptions:\nIf the loan is repaid in full, the profit for the bank is equal to loan_amnt*(1 + 0.25*loan_int_rate)**10 - loan_amnt. This formula assumes that the profit earned by the bank on a 10-year loan is equal to 25% of the interest rate each year, with the other 75% of the interest going to things like salaries for the people who manage the bank. It is extremely simplistic and does not account for inflation, amortization over time, opportunity costs, etc. If the borrower defaults on the loan, the “profit” for the bank is equal to loan_amnt*(1 + 0.25*loan_int_rate)**3 - 1.7*loan_amnt. This formula corresponds to the same profit-earning mechanism as above, but assumes that the borrower defaults three years into the loan and that the bank loses 70% of the principal. These modeling assumptions are extremely simplistic! You may deviate from these assumptions if you have relevant prior knowledge to inform your approach!!\nBased on your assumptions, determine the threshold t which optimizes profit for the bank on the training set. Explain your approach, including labeled visualizations where appropriate, and include a final estimate of the bank’s expected profit per borrower on the training set.\n\n\nPart E: Evaluate Your Model from the Bank’s Perspective\nOnly after you have finalized your weight w vector and threshold t, evaluate your automated decision-process on the test set:\n\nurl = \"https://raw.githubusercontent.com/PhilChodrow/ml-notes/main/data/credit-risk/test.csv\"\ndf_test = pd.read_csv(url)\n\nWhat is the expected profit per borrower on the test set? Is it similar to your profit on the training set?\n\n\nPart F: Evaluate Your Model From the Borrower’s Perspective\nNow evaluate your model from the (aggregate) perspective of the prospective borrowers. Please quantitatively address the following questions, using the predictions of your model on the test data:\n\nIs it more difficult for people in certain age groups to access credit under your proposed system?\nIs it more difficult for people to get loans in order to pay for medical expenses? How does this compare with the actual rate of default in that group? What about people seeking loans for business ventures or education?\nHow does a person’s income level impact the ease with which they can access credit under your decision system?\n\n\n\nPart G: Write and Reflect\nWrite a brief introductory paragraph for your blog post describing the overall purpose, methodology, and findings of your study. Then, write a concluding discussion describing what you found and what you learned through from this blog post.\nPlease include one paragraph discussing the following questions:\nConsidering that people seeking loans for medical expense have high rates of default, is it fair that it is more difficult for them to obtain access to credit? You are free to define “fairness” in a way that makes sense to you, but *please write down your definition as part of your discussion."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "My Awesome CSCI 0451 Blog",
    "section": "",
    "text": "Whose Costs?\n\n\n\n\n\n‘Optimal’ Decision-Making\n\n\n\n\n\nMar 7, 2024\n\n\nCharlie Moore\n\n\n\n\n\n\n\n\n\n\n\n\nPenguins Blog\n\n\n\n\n\nPalmer Penguins!\n\n\n\n\n\nFeb 19, 2024\n\n\nCharlie Moore\n\n\n\n\n\n\nNo matching items"
  }
]